@using ProjectHermes.ShoppingList.Frontend.Models.Items;
@using Models = ProjectHermes.ShoppingList.Frontend.Models.Items;

<div id="itemTypes">
    <div class="mt-3 d-flex justify-content-start align-items-center">
        <div class="pt-2 pb-2 mr-2">Types</div>
        <Button class="d-flex align-items-center" OnClick="OnAddItemTypeButtonClicked">
            <Icon Type="plus"></Icon>
        </Button>
    </div>
    <div class="pl-4">
        @for(int i = 0; i < State.EditedItem.ItemTypes.Count; i++)
        {
            <ItemType State="State" ComponentIndex="i"></ItemType>
            @if (i < State.EditedItem.ItemTypes.Count - 1)
            {
                <hr class="my-0"/>
            }
        }
    </div>
</div>

@code {
    [Parameter] public ItemsState State { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        State.StateChanged += StateHasChanged;
    }

    private void OnAddItemTypeButtonClicked()
    {
        State.EditedItem.ItemTypes.Add(
            new Models.ItemType(0, "New type", Enumerable.Empty<StoreItemAvailability>()));

        State.StateChanged();
    }
}
