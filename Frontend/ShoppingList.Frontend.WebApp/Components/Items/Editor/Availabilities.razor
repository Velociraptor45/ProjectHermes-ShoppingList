@using ProjectHermes.ShoppingList.Frontend.Models.Items;
@using ProjectHermes.ShoppingList.Frontend.Models.Items.Models

<div>
    <div class="mt-3 d-flex justify-content-start align-items-center">
        <div class="font-weight-bold mr-2">Stores</div>
        <Button class="d-flex align-items-center" Size="@AntSizeLDSType.Small" OnClick="OnAddStoreButtonClicked"
                Disabled="@(!Available.GetNotRegisteredStores(State.Stores).Any())">
            <Icon Type="plus"></Icon>
        </Button>
    </div>
    <div class="py-2">
        @for (int i = 0; i < Available.Availabilities.Count; i++)
        {
            <div class="pb-3">
                <Availability State="@State"
                              Model="@Available.Availabilities[i]"
                              Index="i"
                              OnRemove="index => Available.Availabilities.RemoveAt(index)"></Availability>
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public ItemsState State { get; set; }
    [Parameter] public IAvailable Available { get; set; }

    private void OnAddStoreButtonClicked()
    {
        Available.AddStore(State.Stores);
        State.StateChanged();
    }
}