@using ProjectHermes.ShoppingList.Frontend.Models;
@using ProjectHermes.ShoppingList.Frontend.Models.Items;
@using ProjectHermes.ShoppingList.Frontend.WebApp.Pages.Items.Models
@using ProjectHermes.ShoppingList.Frontend.WebApp.Pages.Items.Services
@using ProjectHermes.ShoppingList.Frontend.WebApp.Services.Error;

@inject IItemsApiService loadingService;

<div class="d-flex">
    <div class="h4">Items</div>
    <Button @onclick="OnCreateItemButtonClicked" Class="d-flex align-items-center ml-auto">
        <Icon Type="plus"></Icon>
    </Button>
</div>
<div class="mb-2">
    <Tabs>
        <TabPane Tab="Search" Key="1">
            <ItemSearchTab State="State" FragmentCreator="FragmentCreator"></ItemSearchTab>
        </TabPane>
        <TabPane Tab="Filter" Key="2">
            <ItemFilterTab State="State" FragmentCreator="FragmentCreator"></ItemFilterTab>
        </TabPane>
    </Tabs>
</div>
<div>
    <!-- result item list -->
    @foreach (var item in State.Items.ToList())
    {
        <FilterResult State="@State"
                      FragmentCreator="@FragmentCreator"
                      Item="@item"></FilterResult>
    }
</div>

@code {
    [Parameter] public ItemsState State { get; set; }
    [Parameter] public IAsyncRetryFragmentCreator FragmentCreator { get; set; }

    private void OnCreateItemButtonClicked()
    {
        State.EnterEditorForNewItem();
    }
}